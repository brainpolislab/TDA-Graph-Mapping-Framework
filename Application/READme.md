# Mapping Framework Application
Following validation, the mapping framework has been implemented in a real-world scenario. The objective was to integrate the mapping framework into the realm of personalised medicine, thereby augmenting the diagnosis and treatment of psychiatric disorders.  
The dataset comprises a total of 587 subjects categorized into the following diagnostic classes: Healthy Control (HC), Recent Onset Psychosis (ROP), Recent Onset Depression (ROD), and Clinical High Risk (CHR). Each subject is linked with environmental characteristics, structural magnetic resonance imaging features (sMRI), and functional magnetic resonance imaging features (fMRI).  

For each feature set, a normative TDA graph has been systematically constructed, utilizing data exclusively from HC subjects. Subsequently, the barycenter of the graph has been determined as follows: the centroid for each node within the TDA graph has been computed, and then the barycenter has been calculated employing a weighted mean. Specifically, each centroid in the calculation has been weighted by the numerosity of the corresponding node, representing the total count of subjects contained within that node.  
Following the construction of the normative graph, the subsequent phase entailed the computation of distances between the centroid of each node within the graph and the previously calculated barycenter. This distribution of distances will serve as a reference for subsequent analyses.

With the distribution of distances at hand, the application proceeds with the subsequent mapping of patient samples into the normative TDA graph. The patient sample may (a) be accurately mapped inside a node of the graph, (b) remain unmapped within any node of the graph, or (c) be mapped within those "noisy" nodes. Notably, owing to the TDA algorithm, it is conceivable for a patient to be mapped inside more than one node of the normative graph. In such instances, the centroid of each mapped node is computed, considering also the patient, and subsequently, the distance from the barycenter is calculated for each node. Finally, these distances are averaged.  
Alternatively, in situations where a patient is not associated with any node of the graph, it is regarded independently, and subsequently, the distance between the patient and the barycenter is computed. Furthermore, in cases involving "noisy" nodes, distances are not computed, and the patient is treated as an outlier.

A schematic representation of the pipeline described above is presented below:
![Mapping Framework application](/Images/framework_application.png)


**N.B.** It is important to note that even if a new patient has been correctly mapped inside some nodes of the normative TDA graph, it may occur that among those nodes, some are indeed nodes of the graph while others are identified as "noisy" nodes. In such cases, only the "actual" nodes are considered when computing the distance with the barycenter, with the assumption that "noisy" nodes are akin to outliers.
